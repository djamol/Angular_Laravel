{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { catchError } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"./cookie.service\";\nexport class AuthService {\n  constructor(http, location, cookie) {\n    this.http = http;\n    this.location = location;\n    this.cookie = cookie;\n    this.adminStatus = false;\n    // HTTP headers, if needed\n    this.httpOptions = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json'\n      })\n    };\n    this.apiUrl = this.getApiUrl('api');\n    this.apiUrl = window.location.href.replace('/assets/angular', '');\n    this.apiUrl = this.apiUrl + \"api\";\n    console.log(\"apiURL\", this.apiUrl);\n    //this.apiUrl=\"https://amol.com/api\"\n    //console.log(\"apiURL\",this.apiUrl);\n  }\n\n  getApiUrl(endpoint) {\n    const domainUrl = this.location.prepareExternalUrl('');\n    const apiUrl = `${domainUrl}/api/${endpoint}`;\n    return apiUrl;\n  }\n  getToken() {\n    return this.cookie.readCookie('token');\n  }\n  isAdmin() {\n    let httpOptions = {};\n    let auth = 'Bearer ' + this.getToken();\n    console.log(\"auth test->\", auth.replaceAll('\"', ''));\n    this.httpOptions = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'Authorization': auth.replaceAll('\"', '')\n      })\n    };\n    return this.http.get(this.apiUrl + \"/admin\", this.httpOptions);\n  }\n  login(auth) {\n    return this.http.post(this.apiUrl + \"/login\", auth, this.httpOptions);\n  }\n  register(auth) {\n    return this.http.post(this.apiUrl + \"/register\", auth, this.httpOptions).pipe(catchError(error => {\n      throw error;\n    }));\n  }\n}\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Location), i0.ɵɵinject(i3.CookieService));\n};\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AACA,SAAqBA,WAAW,QAAQ,sBAAsB;AAG9D,SAASC,UAAU,QAAQ,gBAAgB;;;;;AAM3C,OAAM,MAAOC,WAAW;EAKtBC,YAAoBC,IAAgB,EAASC,QAAiB,EAAQC,MAAqB;IAAvE,SAAI,GAAJF,IAAI;IAAqB,aAAQ,GAARC,QAAQ;IAAiB,WAAM,GAANC,MAAM;IAFvE,gBAAW,GAAE,KAAK;IAgBvB;IACA,gBAAW,GAAG;MACZC,OAAO,EAAE,IAAIP,WAAW,CAAC;QAAE,cAAc,EAAE;MAAkB,CAAC;KAC/D;IAhBC,IAAI,CAACQ,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,KAAK,CAAC;IACvC,IAAI,CAACD,MAAM,GAAIE,MAAM,CAACL,QAAQ,CAACM,IAAI,CAACC,OAAO,CAAC,iBAAiB,EAAC,EAAE,CAAC;IACjE,IAAI,CAACJ,MAAM,GAAC,IAAI,CAACA,MAAM,GAAC,KAAK;IAC7BK,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAC,IAAI,CAACN,MAAM,CAAC;IACjC;IACA;EAEE;;EACAC,SAAS,CAACM,QAAgB;IACxB,MAAMC,SAAS,GAAG,IAAI,CAACX,QAAQ,CAACY,kBAAkB,CAAC,EAAE,CAAC;IACtD,MAAMT,MAAM,GAAG,GAAGQ,SAAS,QAAQD,QAAQ,EAAE;IAC7C,OAAOP,MAAM;EACf;EAKAU,QAAQ;IACN,OAAO,IAAI,CAACZ,MAAM,CAACa,UAAU,CAAC,OAAO,CAAC;EACxC;EAEAC,OAAO;IACN,IAAIC,WAAW,GAAG,EAAE;IACjB,IAAIC,IAAI,GAAG,SAAS,GAAG,IAAI,CAACJ,QAAQ,EAAE;IACtCL,OAAO,CAACC,GAAG,CAAC,aAAa,EAACQ,IAAI,CAACC,UAAU,CAAC,GAAG,EAAC,EAAE,CAAC,CAAC;IAClD,IAAI,CAACF,WAAW,GAAE;MACdd,OAAO,EAAE,IAAIP,WAAW,CAAC;QACvB,cAAc,EAAE,kBAAkB;QAClC,eAAe,EAAEsB,IAAI,CAACC,UAAU,CAAC,GAAG,EAAC,EAAE;OACxC;KACF;IACH,OAAO,IAAI,CAACnB,IAAI,CAACoB,GAAG,CAAM,IAAI,CAAChB,MAAM,GAAE,QAAQ,EAAE,IAAI,CAACa,WAAW,CAAC;EACtE;EACAI,KAAK,CAACH,IAAS;IACb,OAAO,IAAI,CAAClB,IAAI,CAACsB,IAAI,CAAM,IAAI,CAAClB,MAAM,GAAE,QAAQ,EAAEc,IAAI,EAAE,IAAI,CAACD,WAAW,CAAC;EAC3E;EACAM,QAAQ,CAACL,IAAS;IAChB,OAAO,IAAI,CAAClB,IAAI,CAACsB,IAAI,CAAM,IAAI,CAAClB,MAAM,GAAE,WAAW,EAAEc,IAAI,EAAE,IAAI,CAACD,WAAW,CAAC,CAACO,IAAI,CAC7E3B,UAAU,CAAE4B,KAAK,IAAI;MACjB,MAAMA,KAAK;IACf,CAAC,CAAC,CACH;EACL;;AAhDW3B,WAAW;mBAAXA,WAAW;AAAA;AAAXA,WAAW;SAAXA,WAAW;EAAA4B,SAAX5B,WAAW;EAAA6B,YAFV;AAAM","names":["HttpHeaders","catchError","AuthService","constructor","http","location","cookie","headers","apiUrl","getApiUrl","window","href","replace","console","log","endpoint","domainUrl","prepareExternalUrl","getToken","readCookie","isAdmin","httpOptions","auth","replaceAll","get","login","post","register","pipe","error","factory","providedIn"],"sourceRoot":"","sources":["/var/www/html/openpbx/resources/angular/src/app/service/auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { Location } from '@angular/common';\nimport { catchError } from 'rxjs/operators';\n\nimport { CookieService } from './cookie.service';\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService {\n\n    public apiUrl: any;\npublic adminStatus =false;\n\n  constructor(private http: HttpClient,private location:Location,public cookie :CookieService) {\n    this.apiUrl = this.getApiUrl('api');\nthis.apiUrl =  window.location.href.replace('/assets/angular','');\nthis.apiUrl=this.apiUrl+\"api\";\nconsole.log(\"apiURL\",this.apiUrl);\n//this.apiUrl=\"https://amol.com/api\"\n//console.log(\"apiURL\",this.apiUrl);\n\n  }\n  getApiUrl(endpoint: string): string {\n    const domainUrl = this.location.prepareExternalUrl('');\n    const apiUrl = `${domainUrl}/api/${endpoint}`;\n    return apiUrl;\n  }\n  // HTTP headers, if needed\n  httpOptions = {\n    headers: new HttpHeaders({ 'Content-Type': 'application/json'})\n  };\n  getToken(){\n    return this.cookie.readCookie('token');\n  }\n\n  isAdmin(): Observable<any> {\n   let httpOptions = {};\n      let auth = 'Bearer ' + this.getToken();\n      console.log(\"auth test->\",auth.replaceAll('\"',''));\n      this.httpOptions ={\n          headers: new HttpHeaders({\n            'Content-Type': 'application/json',\n            'Authorization': auth.replaceAll('\"','')\n          })\n        };\n      return this.http.get<any>(this.apiUrl+ \"/admin\", this.httpOptions);\n  }\n  login(auth: any): Observable<any> {\n    return this.http.post<any>(this.apiUrl+ \"/login\", auth, this.httpOptions);\n  }\n  register(auth: any): Observable<any> {\n    return this.http.post<any>(this.apiUrl+ \"/register\", auth, this.httpOptions).pipe(\n        catchError((error) => {\n            throw error;\n        })\n      );\n  }\n\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}